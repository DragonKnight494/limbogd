
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIMBO Memory Test</title>

<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
    touch-action: manipulation;
  }

  .keys {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: grid;
    grid-template-columns: repeat(4, 90px);
    gap: 20px;
  }

  .key {
    width: 90px;
    height: 90px;
    background: red;
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.15s, transform 0.1s;
  }

  .key img {
    width: 65%;
    pointer-events: none;
  }

  .green {
    background: #00ff66;
  }

  .result {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 40vw;
    font-weight: bold;
    opacity: 0;
    pointer-events: none;
  }

  .show { opacity: 1; }
  .check { color: #00ff66; }
  .x { color: red; }
</style>
</head>

<body>

<div class="keys" id="keys">
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
  <div class="key"><img src="key.png"></div>
</div>

<div class="result check" id="check">✔</div>
<div class="result x" id="x">✖</div>

<script>
  const keysContainer = document.getElementById("keys");
  const keys = Array.from(document.querySelectorAll(".key"));
  const check = document.getElementById("check");
  const xMark = document.getElementById("x");

  let correctKey = null;
  let canClick = false;
  let scrambleInterval = null;

  function shuffleKeys() {
    keys.sort(() => Math.random() - 0.5);
    keys.forEach(k => keysContainer.appendChild(k));
  }

  function scramble(speed) {
    shuffleKeys();
    keys.forEach(k => {
      const x = (Math.random() - 0.5) * 20;
      const y = (Math.random() - 0.5) * 20;
      k.style.transform = `translate(${x}px, ${y}px)`;
    });
  }

  function startGame() {
    canClick = false;
    check.classList.remove("show");
    xMark.classList.remove("show");

    keys.forEach(k => {
      k.classList.remove("green");
      k.style.transform = "translate(0,0)";
    });

    // Pick correct key
    correctKey = keys[Math.floor(Math.random() * keys.length)];

    // SHOW GREEN (REVEAL)
    correctKey.classList.add("green");

    setTimeout(() => {
      // HIDE GREEN
      correctKey.classList.remove("green");

      // START SCRAMBLE
      let speed = 300;
      scrambleInterval = setInterval(() => {
        scramble(speed);

        // Random speed changes
        speed = 100 + Math.random() * 400;
        clearInterval(scrambleInterval);
        scrambleInterval = setInterval(() => scramble(speed), speed);
      }, speed);

      // STOP AFTER ~15 SECONDS
      setTimeout(() => {
        clearInterval(scrambleInterval);
        keys.forEach(k => k.style.transform = "translate(0,0)");
        canClick = true;
      }, 15000);

    }, 1000); // green shown for 1 second
  }

  keys.forEach(key => {
    const select = () => {
      if (!canClick) return;
      canClick = false;

      if (key === correctKey) {
        check.classList.add("show");
      } else {
        xMark.classList.add("show");
      }

      setTimeout(startGame, 1500);
    };

    key.addEventListener("click", select);
    key.addEventListener("touchstart", select, { passive: true });
  });

  startGame();
</script>

</body>
</html>

